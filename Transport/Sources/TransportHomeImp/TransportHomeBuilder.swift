//
//  TransportHomeBuilder.swift
//  MiniSuperApp
//
//  Created by 정국희 on 2022/03/28.
//  Copyright (c) 2022 ___ORGANIZATIONNAME___. All rights reserved.
//
//  This file was generated by the Clean Swift Xcode Templates so
//  you can apply clean architecture to your iOS and Mac projects,
//  see http://clean-swift.com
//

import UIKit

import CombineUtil
import FinanceRepository
import Topup
import TransportHome
import CleanSwiftUtil

// MARK: - TransportHomeBuilder

public final class TransportHomeBuilder: Builder<TransportHomeDependency> {
    
}

// MARK: - TransportHomeBuildingLogic

extension TransportHomeBuilder: TransportHomeBuildingLogic {
    public func build(withListener listener: TransportHomeListener) -> Destination {
        let component = TransportHomeComponent(dependency: dependency)
        let viewController = TransportHomeViewController()
        let interactor = TransportHomeInteractor(
            worker: TransportHomeWorker(),
            dependency: component,
            listener: listener
        )
        let presenter = TransportHomePresenter()
        let router = TransportHomeRouter(
            viewController: viewController,
            topupBuildable: component.topupBuildable
        )
        viewController.interactor = interactor
        interactor.router = router
        interactor.presenter = presenter
        presenter.viewController = viewController

        return viewController
    }
}

// MARK: - TransportHomeDependency

public protocol TransportHomeDependency: Dependency {
    var superPayRepository: SuperPayRepositoryAvailable { get }
    var cardOnFileRepository: CardOnFileRepositoryAvailable { get }
    var topupBuildable: TopupBuildingLogic { get }
}

// MARK: - TransportHomeComponent

final class TransportHomeComponent: Component<TransportHomeDependency>, TransportHomeInteractorDependency {
    var cardOnFileRepository: CardOnFileRepositoryAvailable { dependency.cardOnFileRepository }
    
    var superPayRepository: SuperPayRepositoryAvailable { dependency.superPayRepository }
    var superPayBalance: ReadOnlyCurrentValuePublisher<Double> { dependency.superPayRepository.balance }
    var topupBuildable: TopupBuildingLogic { dependency.topupBuildable }
}
